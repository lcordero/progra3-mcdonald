<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MACDONALD</title>
    <script src="/assets/jquery.js"></script>
    <script src="/assets/socket.io.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<table style="width:100%" class="datos">
        <thead class="orden">
            <tr>
                <th>Combo</th>
                <th>Bebida</th>
                <th>Acompa√±amiento</th>
            </tr>
        </thead>
        <tbody class="cuerpo_t"></tbody>
    </table>

<script>

    var inputsss = $(":input")
    var button = $(".guardar")
    var cuerpo_t = $(".cuerpo_t")
    

    var socket = io.connect(window.location.host);
    socket.on('conect', function() {
        console.log('conectado nuevo menu con socket')
    });

    socket.on("nuevo_menu", function(admin){
        if (!admin.combo || !admin.bebida || !admin.acompanamiento ) return
        cuerpo_t.append(`
            <tr>
            <th>`+ admin.combo +`</th>
            <th>`+ admin.bebida +`</th>
            <th>`+ admin.acompanamiento +`</th>
            </tr>
        `)
    })

    button.on("click", function(){
        console.log("click on send info")
        socket.emit('nuevo_menu', {
            'combo': $(".combo").val(), 
            'bebida': $(".bebida").val(),
            'acompanamiento': $(".acomp").val()
        });

        $.post( "http://localhost:3001/api/admin", { 
            combo : $(".combo").val(),
            bebida : $(".bebida").val(),
            acompanamiento : $(".acomp").val()
        });
        inputsss.val('');
    })
   
var contenido = function(url){
    $.get( url, function( data ) {
        cuerpo_t.empty()
    $.each( data.admin, function( i, admin ) {
        cuerpo_t.append(`
            <tr>
            <th>`+ admin.combo +`</th>
            <th>`+ admin.bebida +`</th>
            <th>`+ admin.acompanamiento +`</th>
            <td><button class="listo">Listo</button> <button class="cancelar">Cancelar</button></td>
            </tr>
            `)
        })
    })
}
        contenido('http://'+ window.location.host +'/api/admin')
</script>
</html>